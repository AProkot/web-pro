<!doctype html>
<html>
<head>
    <title>Menu</title>
    <link rel="icon" href="style/img/icon.png">
    <meta charset="UTF-8">
    <link rel="stylesheet" href="style/main.css">
    <link rel="stylesheet" href="style/menu.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
</head>
<body>
<div class="container-fluid body">
    <div class="row page_top">
        <span class="title">Осьметодичка</span>
        <span class="right_part">
            <span id="username"></span><input type="button" class="btn btn-info cornerbtn" value="Выйти"></span>
        </span>
    </div>
    <div class="row menu-main">
        <div class="col-4 opt">
            <label for="plus">Добавить мероприятие</label>
            <a id="plus" href="/add"><img src="style/img/plus.png" class="image"></a>
            <form action="/favorite">
                <button class="btn btn-warning">Избранное</button>
            </form>
        </div>
        <div class="col-4"></div>
        <div class="col-4 opt">
            <label for="rainbow">Мероприятия</label>
            <a id="rainbow" href="/mero"><img src="style/img/rainbow.png" class="image"></a>
            <form action="/new">
                <button class="btn btn-danger" id="new"></button>
            </form>
        </div>
    </div>

</div>
<script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js'></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js'></script>
<script>
    function getUsername(){
    var xhr = new XMLHttpRequest();
    xhr.open('GET', '/getusername', true);

    xhr.onload = function () {
        let data = xhr.responseText;
        document.getElementById("username").innerHTML = data;
    }
    xhr.send()
    }
    function countNew(){
        var xhr = new XMLHttpRequest();
        xhr.open('GET', '/countnew', true);

        xhr.onload = function () {
            let data = xhr.responseText;
            if (data>0)
                document.getElementById("new").innerHTML = 'Новые мероприятия + ' + data;
            else
                document.getElementById("new").innerHTML = 'Нет новых мероприятий';
        }
        xhr.send()
    }

    $( ".cornerbtn").click(function() {
        window.location.href = `/logout`;
    });
    getUsername();
    countNew();
</script>
</body>
</html>